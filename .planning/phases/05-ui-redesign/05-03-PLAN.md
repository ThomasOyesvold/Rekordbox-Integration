---
phase: 05-ui-redesign
plan: 03
type: execute
wave: 2
depends_on: [01, 02]
files_modified:
  - renderer/components/AppHeader.jsx
  - renderer/components/SetupWizard.jsx
  - renderer/App.jsx
  - renderer/styles/components.css
autonomous: true

must_haves:
  truths:
    - App header shows logo with glass morphism effect
    - Setup wizard guides users through import/configure/parse steps
    - Drag-and-drop zone highlights on file drag-over
    - Progress indicator shows current wizard step
    - Recent imports shown as clickable cards
  artifacts:
    - renderer/components/AppHeader.jsx
    - renderer/components/SetupWizard.jsx
    - renderer/styles/components.css
  key_links:
    - AppHeader integrated into App.jsx layout
    - SetupWizard replaces raw input setup
    - Uses Button and Card components from Plan 02
---

<objective>
Create modern app shell with glass morphism header and guided setup wizard with drag-and-drop.

Purpose: Transform raw setup into intuitive guided experience with professional header.
Output: AppHeader component and multi-step SetupWizard with progress indicators and file drop zone.
</objective>

<execution_context>
@/home/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/home/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/UI-REDESIGN-PLAN.md
@.planning/phases/05-ui-redesign/05-01-PLAN.md
@.planning/phases/05-ui-redesign/05-02-PLAN.md

# UI components from Plan 02
@renderer/components/ui/Button.jsx
@renderer/components/ui/Card.jsx

# Current app structure
@renderer/App.jsx
@renderer/index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AppHeader component</name>
  <files>renderer/components/AppHeader.jsx</files>
  <action>
Create modern header with glass morphism effect and logo:

```jsx
import { Settings } from 'lucide-react';
import { IconButton } from './ui/Button';
import './AppHeader.css';

export function AppHeader({ onSettingsClick }) {
  return (
    <header className="app-header">
      <div className="header-left">
        <div className="logo">
          <svg className="logo-icon" viewBox="0 0 24 24" width="24" height="24">
            <path
              d="M3 12h4l3-9 4 18 3-9h4"
              stroke="url(#waveform-gradient)"
              strokeWidth="2"
              fill="none"
              strokeLinecap="round"
              strokeLinejoin="round"
            />
            <defs>
              <linearGradient id="waveform-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stopColor="#667eea" />
                <stop offset="100%" stopColor="#764ba2" />
              </linearGradient>
            </defs>
          </svg>
          <span className="logo-text">Rekordbox Flow Analyzer</span>
        </div>
      </div>
      <div className="header-right">
        <IconButton
          icon={<Settings size={20} />}
          onClick={onSettingsClick}
          aria-label="Settings"
        />
      </div>
    </header>
  );
}
```

**AppHeader.css:**
```css
.app-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-6);
  background: rgba(17, 24, 39, 0.8);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border-subtle);
  z-index: 1000;
}

.logo {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.logo-icon {
  width: 28px;
  height: 28px;
}

.logo-text {
  font-size: var(--text-lg);
  font-weight: var(--weight-semibold);
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.header-right {
  display: flex;
  gap: var(--space-2);
}
```
  </action>
  <verify>
```bash
# Component exists
ls renderer/components/AppHeader.jsx

# Uses Lucide icons
grep "from 'lucide-react'" renderer/components/AppHeader.jsx

# Has glass morphism effect
grep "backdrop-filter" renderer/components/AppHeader.css
```
  </verify>
  <done>
AppHeader component created with glass morphism, gradient logo, settings button
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SetupWizard component</name>
  <files>renderer/components/SetupWizard.jsx</files>
  <action>
Create guided setup wizard with drag-and-drop and progress indicator:

```jsx
import { useState, useRef } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { Upload, FolderOpen, Loader2 } from 'lucide-react';
import { Button } from './ui/Button';
import { Card, CardHeader, CardContent } from './ui/Card';
import './SetupWizard.css';

export function SetupWizard({ onFileSelect, isLoading, recentImports = [] }) {
  const [dragActive, setDragActive] = useState(false);
  const fileInputRef = useRef(null);

  const handleDrag = (e) => {
    e.preventDefault();
    e.stopPropagation();
    if (e.type === 'dragenter' || e.type === 'dragover') {
      setDragActive(true);
    } else if (e.type === 'dragleave') {
      setDragActive(false);
    }
  };

  const handleDrop = (e) => {
    e.preventDefault();
    e.stopPropagation();
    setDragActive(false);

    if (e.dataTransfer.files && e.dataTransfer.files[0]) {
      const file = e.dataTransfer.files[0];
      if (file.name.endsWith('.xml')) {
        onFileSelect(file);
      }
    }
  };

  const handleFileInput = (e) => {
    if (e.target.files && e.target.files[0]) {
      onFileSelect(e.target.files[0]);
    }
  };

  const handleBrowseClick = () => {
    fileInputRef.current?.click();
  };

  return (
    <div className="setup-wizard">
      <Card>
        <CardHeader>
          <div className="wizard-header">
            <Upload size={24} />
            <div>
              <h2 className="wizard-title">Get Started</h2>
              <p className="wizard-subtitle">
                Import your Rekordbox library to start analyzing tracks
              </p>
            </div>
          </div>
        </CardHeader>

        <CardContent>
          <motion.div
            className={`drop-zone ${dragActive ? 'drag-active' : ''}`}
            onDragEnter={handleDrag}
            onDragLeave={handleDrag}
            onDragOver={handleDrag}
            onDrop={handleDrop}
            animate={dragActive ? { scale: 1.02 } : { scale: 1 }}
            transition={{ duration: 0.2 }}
          >
            {isLoading ? (
              <div className="drop-zone-loading">
                <Loader2 className="spinner" size={32} />
                <span>Parsing library...</span>
              </div>
            ) : (
              <>
                <FolderOpen size={48} className="drop-zone-icon" />
                <div className="drop-zone-text">
                  <span className="drop-zone-main">Drop XML file here</span>
                  <span className="drop-zone-sub">or</span>
                </div>
                <Button variant="primary" onClick={handleBrowseClick}>
                  Browse Computer
                </Button>
              </>
            )}
          </motion.div>

          <input
            ref={fileInputRef}
            type="file"
            accept=".xml"
            onChange={handleFileInput}
            style={{ display: 'none' }}
          />

          {recentImports.length > 0 && (
            <div className="recent-imports">
              <h3 className="recent-title">Recent imports</h3>
              <div className="recent-list">
                {recentImports.map((import_, idx) => (
                  <motion.div
                    key={idx}
                    className="recent-item"
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: idx * 0.05 }}
                    onClick={() => onFileSelect(import_.path)}
                  >
                    <FolderOpen size={16} />
                    <div className="recent-info">
                      <span className="recent-name">{import_.name}</span>
                      <span className="recent-meta">
                        {import_.trackCount?.toLocaleString()} tracks
                      </span>
                    </div>
                  </motion.div>
                ))}
              </div>
            </div>
          )}
        </CardContent>
      </Card>
    </div>
  );
}
```

**SetupWizard.css:**
```css
.setup-wizard {
  max-width: 600px;
  margin: 0 auto;
  padding: var(--space-8);
}

.wizard-header {
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
}

.wizard-title {
  font-size: var(--text-2xl);
  font-weight: var(--weight-bold);
  color: var(--text-primary);
  margin-bottom: var(--space-1);
}

.wizard-subtitle {
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.drop-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-4);
  min-height: 240px;
  padding: var(--space-8);
  border: 2px dashed var(--border-medium);
  border-radius: var(--radius-lg);
  background: var(--bg-tertiary);
  transition: all var(--transition-base);
  cursor: pointer;
}

.drop-zone.drag-active {
  border-color: var(--accent-primary);
  background: rgba(59, 130, 246, 0.1);
  box-shadow: 0 0 30px rgba(59, 130, 246, 0.2);
}

.drop-zone-icon {
  color: var(--text-tertiary);
}

.drop-zone-text {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-2);
}

.drop-zone-main {
  font-size: var(--text-lg);
  font-weight: var(--weight-medium);
  color: var(--text-primary);
}

.drop-zone-sub {
  font-size: var(--text-sm);
  color: var(--text-tertiary);
}

.drop-zone-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-3);
  color: var(--text-secondary);
}

.spinner {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.recent-imports {
  margin-top: var(--space-6);
}

.recent-title {
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--text-secondary);
  margin-bottom: var(--space-3);
}

.recent-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.recent-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  background: var(--bg-tertiary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-base);
}

.recent-item:hover {
  background: var(--bg-elevated);
  border-color: var(--accent-primary);
  transform: translateX(4px);
}

.recent-info {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  flex: 1;
}

.recent-name {
  font-size: var(--text-sm);
  color: var(--text-primary);
}

.recent-meta {
  font-size: var(--text-xs);
  color: var(--text-tertiary);
}
```
  </action>
  <verify>
```bash
# Component exists
ls renderer/components/SetupWizard.jsx

# Has drag-and-drop handlers
grep -E "(handleDrag|handleDrop)" renderer/components/SetupWizard.jsx

# Uses Framer Motion
grep "from 'framer-motion'" renderer/components/SetupWizard.jsx

# Has styling
grep "drop-zone" renderer/components/SetupWizard.css
```
  </verify>
  <done>
SetupWizard created with drag-and-drop, recent imports, loading states, smooth animations
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate AppHeader and SetupWizard into App</name>
  <files>renderer/App.jsx, renderer/styles/components.css</files>
  <action>
Update App.jsx to use new components:

1. Import new components:
```javascript
import { AppHeader } from './components/AppHeader';
import { SetupWizard } from './components/SetupWizard';
```

2. Update App layout structure:
```jsx
function App() {
  // ... existing state ...

  return (
    <div className="app-shell">
      <AppHeader onSettingsClick={() => console.log('Settings')} />

      <main className="app-main">
        {!xmlFile ? (
          <SetupWizard
            onFileSelect={handleFileSelect}
            isLoading={isLoadingXml}
            recentImports={[]}
          />
        ) : (
          // Existing content
          <>
            {/* Library stats, track table, etc. */}
          </>
        )}
      </main>
    </div>
  );
}
```

3. Add layout styles to components.css:
```css
.app-shell {
  min-height: 100vh;
  background: var(--bg-primary);
}

.app-main {
  padding-top: 64px; /* Header height */
  min-height: calc(100vh - 64px);
}
```
  </action>
  <verify>
```bash
# Components imported
grep "import.*AppHeader" renderer/App.jsx
grep "import.*SetupWizard" renderer/App.jsx

# Used in render
grep "<AppHeader" renderer/App.jsx
grep "<SetupWizard" renderer/App.jsx

# Layout styles exist
grep "app-shell" renderer/styles/components.css
```
  </verify>
  <done>
AppHeader and SetupWizard integrated into App.jsx, replaces raw setup UI
  </done>
</task>

</tasks>

<success_criteria>
**Acceptance:**
1. App shows modern header with glass morphism effect at top
2. Logo displays gradient text with waveform icon
3. Setup wizard shows drag-and-drop zone for XML import
4. Drop zone highlights when file dragged over
5. Browse button opens file picker
6. Loading spinner shows during parsing
7. Recent imports display as clickable cards (if available)

**Testing:**
```bash
# Visual verification in Electron app
npm run start:electron:safe

# Visual checks:
# 1. Header should be semi-transparent with blur effect
# 2. Logo should have gradient purple text
# 3. Settings icon button in top right
# 4. Setup wizard shows centered card with drop zone
# 5. Drag an XML file - drop zone should highlight blue
# 6. Drop file - should trigger file selection
# 7. Click Browse - should open file picker
# 8. After selecting file - loading spinner should appear
# 9. Transitions should be smooth (200ms)
```
</success_criteria>

<must_have_derivation>
**Goal:** Professional app shell with guided setup experience

**Critical behaviors:**
- Header stays fixed at top with glass effect
- Drag-and-drop provides immediate visual feedback
- Setup wizard guides user naturally to first action
- Loading states prevent confusion during parsing
- Smooth animations make interactions satisfying

**Critical artifacts:**
- AppHeader.jsx (glass morphism header with logo)
- SetupWizard.jsx (drag-and-drop import wizard)
- AppHeader.css and SetupWizard.css (styling)

**Critical connections:**
- AppHeader integrated into app shell layout
- SetupWizard replaces raw input UI from current App.jsx
- Uses Button and Card components from Plan 02
- Framer Motion provides smooth animations
- Lucide React provides icons (Upload, FolderOpen, Settings)
</must_have_derivation>
