---
phase: 05-ui-redesign
plan: 04
type: execute
wave: 2
depends_on: [01, 02]
files_modified:
  - renderer/components/TrackTable.jsx
  - renderer/components/PlaylistCard.jsx
  - renderer/components/StatCard.jsx
  - renderer/styles/components.css
autonomous: true

must_haves:
  truths:
    - Track rows show hover effects with left border accent
    - Playing track has animated pulsing indicator
    - Column headers are sticky with blur backdrop
    - Playlist cards display confidence with color-coded badges
    - Stat cards show metrics with gradient icons
  artifacts:
    - renderer/components/TrackTable.jsx
    - renderer/components/PlaylistCard.jsx
    - renderer/components/StatCard.jsx
  key_links:
    - TrackTable enhanced with modern styling
    - PlaylistCard uses Card component from Plan 02
    - Uses design system variables from Plan 01
---

<objective>
Style track table with hover effects and create playlist/stat cards with confidence badges and metrics display.

Purpose: Transform functional data displays into polished, visually appealing components.
Output: Enhanced TrackTable, PlaylistCard for Phase 4 playlists, and StatCard for library metrics.
</objective>

<execution_context>
@/home/thomas/.claude/get-shit-done/workflows/execute-plan.md
@/home/thomas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/UI-REDESIGN-PLAN.md
@.planning/phases/05-ui-redesign/05-01-PLAN.md
@.planning/phases/05-ui-redesign/05-02-PLAN.md

# UI components
@renderer/components/ui/Button.jsx
@renderer/components/ui/Card.jsx

# Existing components to enhance
@renderer/App.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create enhanced TrackTable component</name>
  <files>renderer/components/TrackTable.jsx</files>
  <action>
Create modern track table with hover effects and sticky headers:

```jsx
import { motion } from 'framer-motion';
import './TrackTable.css';

export function TrackTable({ tracks, onTrackClick, playingTrackId }) {
  return (
    <div className="track-table-container">
      <div className="track-table">
        <div className="track-table-header">
          <div className="track-col track-col-status"></div>
          <div className="track-col track-col-id">#</div>
          <div className="track-col track-col-title">Title</div>
          <div className="track-col track-col-artist">Artist</div>
          <div className="track-col track-col-bpm">BPM</div>
          <div className="track-col track-col-key">Key</div>
          <div className="track-col track-col-duration">Duration</div>
          <div className="track-col track-col-waveform">Waveform</div>
        </div>

        <div className="track-table-body">
          {tracks.map((track, index) => (
            <TrackRow
              key={track.id || index}
              track={track}
              index={index}
              isPlaying={track.id === playingTrackId}
              onClick={() => onTrackClick(track)}
            />
          ))}
        </div>
      </div>
    </div>
  );
}

function TrackRow({ track, index, isPlaying, onClick }) {
  return (
    <motion.div
      className={`track-row ${isPlaying ? 'playing' : ''}`}
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ delay: index * 0.02, duration: 0.2 }}
      whileHover={{ x: 4 }}
      onClick={onClick}
    >
      <div className="track-col track-col-status">
        {isPlaying && <div className="status-indicator" />}
      </div>
      <div className="track-col track-col-id">{track.TrackID || index + 1}</div>
      <div className="track-col track-col-title">{track.Name || 'Unknown'}</div>
      <div className="track-col track-col-artist">{track.Artist || 'Unknown'}</div>
      <div className="track-col track-col-bpm">
        {track.AverageBpm ? (
          <>
            <span className="bpm-value">{Math.round(track.AverageBpm)}</span>
            <span className="bpm-unit">BPM</span>
          </>
        ) : (
          '-'
        )}
      </div>
      <div className="track-col track-col-key">{track.tonality?.key || '-'}</div>
      <div className="track-col track-col-duration">
        {track.TotalTime ? formatDuration(track.TotalTime) : '-'}
      </div>
      <div className="track-col track-col-waveform">
        {track.anlzWaveform && <MiniWaveform waveform={track.anlzWaveform} />}
      </div>
    </motion.div>
  );
}

function MiniWaveform({ waveform }) {
  if (!waveform?.binColors) return null;

  return (
    <div className="mini-waveform">
      {waveform.binColors.slice(0, 40).map((color, i) => (
        <div
          key={i}
          className="waveform-bar"
          style={{
            background: `rgb(${color.r}, ${color.g}, ${color.b})`,
            opacity: 0.8,
          }}
        />
      ))}
    </div>
  );
}

function formatDuration(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, '0')}`;
}
```

**TrackTable.css:**
```css
.track-table-container {
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  overflow: hidden;
}

.track-table {
  width: 100%;
}

.track-table-header {
  display: grid;
  grid-template-columns: 40px 60px 2fr 1.5fr 100px 80px 100px 200px;
  gap: var(--space-2);
  padding: var(--space-4) var(--space-6);
  background: var(--bg-elevated);
  border-bottom: 1px solid var(--border-subtle);
  position: sticky;
  top: 64px; /* Below app header */
  backdrop-filter: blur(8px);
  z-index: 10;
  font-size: var(--text-sm);
  font-weight: var(--weight-semibold);
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.track-table-body {
  max-height: 600px;
  overflow-y: auto;
}

.track-row {
  display: grid;
  grid-template-columns: 40px 60px 2fr 1.5fr 100px 80px 100px 200px;
  gap: var(--space-2);
  padding: var(--space-4) var(--space-6);
  border-bottom: 1px solid var(--border-subtle);
  cursor: pointer;
  transition: all var(--transition-base);
  position: relative;
}

.track-row:nth-child(even) {
  background: rgba(255, 255, 255, 0.01);
}

.track-row:hover {
  background: var(--bg-tertiary);
}

.track-row:hover::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--accent-primary);
}

.track-row.playing {
  background: rgba(59, 130, 246, 0.1);
}

.track-row.playing::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--accent-primary);
  box-shadow: 0 0 10px var(--accent-primary);
}

.track-col {
  display: flex;
  align-items: center;
  font-size: var(--text-sm);
  color: var(--text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.track-col-title {
  font-weight: var(--weight-medium);
}

.track-col-artist {
  color: var(--text-secondary);
}

.status-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent-primary);
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
    box-shadow: 0 0 8px var(--accent-primary);
  }
  50% {
    opacity: 0.5;
    box-shadow: 0 0 16px var(--accent-primary);
  }
}

.bpm-value {
  font-weight: var(--weight-semibold);
  color: var(--accent-primary);
}

.bpm-unit {
  margin-left: var(--space-1);
  font-size: var(--text-xs);
  color: var(--text-tertiary);
}

.mini-waveform {
  display: flex;
  gap: 1px;
  height: 32px;
  align-items: center;
}

.waveform-bar {
  width: 3px;
  height: 100%;
  border-radius: 2px;
}
```
  </action>
  <verify>
```bash
# Component exists
ls renderer/components/TrackTable.jsx

# Has hover animations
grep "whileHover" renderer/components/TrackTable.jsx

# Has status indicator
grep "status-indicator" renderer/components/TrackTable.jsx

# Styling exists
grep "track-row" renderer/components/TrackTable.css
```
  </verify>
  <done>
TrackTable component created with hover effects, sticky headers, playing indicator, mini waveforms
  </done>
</task>

<task type="auto">
  <name>Task 2: Create PlaylistCard component</name>
  <files>renderer/components/PlaylistCard.jsx</files>
  <action>
Create playlist card for Phase 4 suggested playlists:

```jsx
import { motion } from 'framer-motion';
import { Play, Eye, Music } from 'lucide-react';
import { Card, CardHeader, CardContent, CardFooter } from './ui/Card';
import { Button } from './ui/Button';
import './PlaylistCard.css';

export function PlaylistCard({
  playlist,
  onSample,
  onViewDetails,
}) {
  const confidence = playlist.confidence || 0;
  const confidenceLevel = confidence >= 80 ? 'high' : confidence >= 60 ? 'medium' : 'low';

  return (
    <motion.div
      initial={{ opacity: 0, scale: 0.95 }}
      animate={{ opacity: 1, scale: 1 }}
      transition={{ duration: 0.2 }}
    >
      <Card hoverable className={`playlist-card confidence-${confidenceLevel}`}>
        <CardHeader>
          <div className="playlist-header">
            <div className="playlist-icon">
              <Music size={24} />
            </div>
            <div className="playlist-info">
              <h3 className="playlist-name">{playlist.name || 'Unnamed Playlist'}</h3>
              <div className="playlist-stats">
                <span className="stat">
                  <Music size={14} />
                  <span>{playlist.tracks?.length || 0} tracks</span>
                </span>
                {playlist.bpmRange && (
                  <span className="stat">
                    <span>{playlist.bpmRange.min}-{playlist.bpmRange.max} BPM</span>
                  </span>
                )}
              </div>
            </div>
            <div className={`confidence-badge ${confidenceLevel}`}>
              <span>{Math.round(confidence)}%</span>
            </div>
          </div>
        </CardHeader>

        <CardContent>
          <div className="playlist-preview">
            {playlist.tracks?.slice(0, 3).map((track, i) => (
              <div key={i} className="preview-track">
                <span className="preview-track-number">{i + 1}</span>
                <span className="preview-track-title">{track.Name}</span>
              </div>
            ))}
            {playlist.tracks?.length > 3 && (
              <div className="preview-more">
                +{playlist.tracks.length - 3} more tracks
              </div>
            )}
          </div>
        </CardContent>

        <CardFooter>
          <div className="playlist-actions">
            <Button
              variant="secondary"
              icon={<Play size={16} />}
              onClick={() => onSample?.(playlist)}
            >
              Sample
            </Button>
            <Button
              variant="primary"
              icon={<Eye size={16} />}
              onClick={() => onViewDetails?.(playlist)}
            >
              View Details
            </Button>
          </div>
        </CardFooter>
      </Card>
    </motion.div>
  );
}
```

**PlaylistCard.css:**
```css
.playlist-card {
  position: relative;
  overflow: hidden;
}

.playlist-card.confidence-high::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--gradient-primary);
}

.playlist-card.confidence-medium::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.playlist-card.confidence-low::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.playlist-header {
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
}

.playlist-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  border-radius: var(--radius-md);
  background: var(--gradient-primary);
  color: white;
}

.playlist-info {
  flex: 1;
}

.playlist-name {
  font-size: var(--text-xl);
  font-weight: var(--weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-2);
}

.playlist-stats {
  display: flex;
  gap: var(--space-4);
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.stat {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.confidence-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 56px;
  height: 56px;
  border-radius: var(--radius-full);
  font-size: var(--text-lg);
  font-weight: var(--weight-bold);
}

.confidence-badge.high {
  background: rgba(16, 185, 129, 0.2);
  color: var(--accent-success);
  border: 2px solid var(--accent-success);
}

.confidence-badge.medium {
  background: rgba(245, 158, 11, 0.2);
  color: var(--accent-warning);
  border: 2px solid var(--accent-warning);
}

.confidence-badge.low {
  background: rgba(239, 68, 68, 0.2);
  color: var(--accent-error);
  border: 2px solid var(--accent-error);
}

.playlist-preview {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.preview-track {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.preview-track-number {
  color: var(--text-tertiary);
  min-width: 20px;
}

.preview-track-title {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.preview-more {
  font-size: var(--text-xs);
  color: var(--text-tertiary);
  font-style: italic;
}

.playlist-actions {
  display: flex;
  gap: var(--space-2);
  width: 100%;
}

.playlist-actions button {
  flex: 1;
}
```
  </action>
  <verify>
```bash
# Component exists
ls renderer/components/PlaylistCard.jsx

# Uses Card components
grep "Card" renderer/components/PlaylistCard.jsx

# Has confidence badges
grep "confidence-badge" renderer/components/PlaylistCard.jsx

# Styling exists
grep "playlist-card" renderer/components/PlaylistCard.css
```
  </verify>
  <done>
PlaylistCard component created with confidence badges, track preview, gradient borders
  </done>
</task>

<task type="auto">
  <name>Task 3: Create StatCard component</name>
  <files>renderer/components/StatCard.jsx</files>
  <action>
Create stat card for displaying library metrics:

```jsx
import { motion } from 'framer-motion';
import './StatCard.css';

export function StatCard({ icon: Icon, value, label, trend }) {
  return (
    <motion.div
      className="stat-card"
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      whileHover={{ y: -4, boxShadow: '0 10px 30px rgba(0,0,0,0.5)' }}
      transition={{ duration: 0.2 }}
    >
      <div className="stat-icon">
        <Icon size={24} />
      </div>
      <div className="stat-content">
        <div className="stat-value">
          {typeof value === 'number' ? value.toLocaleString() : value}
        </div>
        <div className="stat-label">{label}</div>
        {trend && (
          <div className={`stat-trend ${trend > 0 ? 'positive' : 'negative'}`}>
            {trend > 0 ? '+' : ''}{trend}%
          </div>
        )}
      </div>
    </motion.div>
  );
}
```

**StatCard.css:**
```css
.stat-card {
  display: flex;
  gap: var(--space-4);
  padding: var(--space-6);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
  transition: all var(--transition-base);
}

.stat-card:hover {
  border-color: var(--accent-primary);
}

.stat-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 56px;
  height: 56px;
  border-radius: var(--radius-md);
  background: var(--gradient-primary);
  color: white;
  flex-shrink: 0;
}

.stat-content {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: var(--space-1);
}

.stat-value {
  font-size: var(--text-2xl);
  font-weight: var(--weight-bold);
  color: var(--text-primary);
  line-height: 1;
}

.stat-label {
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.stat-trend {
  font-size: var(--text-xs);
  font-weight: var(--weight-semibold);
}

.stat-trend.positive {
  color: var(--accent-success);
}

.stat-trend.negative {
  color: var(--accent-error);
}
```
  </action>
  <verify>
```bash
# Component exists
ls renderer/components/StatCard.jsx

# Has hover animation
grep "whileHover" renderer/components/StatCard.jsx

# Styling exists
grep "stat-card" renderer/components/StatCard.css
```
  </verify>
  <done>
StatCard component created with gradient icon, hover effects, trend indicators
  </done>
</task>

</tasks>

<success_criteria>
**Acceptance:**
1. Track table shows hover effects with left blue border
2. Playing track has animated pulsing dot indicator
3. Column headers sticky when scrolling table
4. Track rows have subtle alternating background colors
5. Playlist cards show confidence with color-coded badges (green/yellow/red)
6. High-confidence playlists have gradient top border
7. Stat cards display metrics with gradient icon backgrounds
8. All components use design system variables

**Testing:**
```bash
# Visual verification in Electron app
npm run start:electron:safe

# Track table checks:
# 1. Load library with tracks
# 2. Hover over track row - should highlight with left blue accent
# 3. Play a track - should show pulsing blue dot
# 4. Scroll table - headers should stick below app header
# 5. Alternating rows should have subtle color difference

# Playlist card checks (Phase 4):
# 1. Generate suggested playlists
# 2. High confidence (80%+) should have purple gradient border
# 3. Medium confidence (60-80%) should have orange border
# 4. Low confidence (<60%) should have red border
# 5. Hover card - should lift with shadow
# 6. Preview shows first 3 tracks

# Stat card checks:
# 1. Library stats should show in cards
# 2. Each card has gradient icon background
# 3. Hover card - should lift
# 4. Numbers should be formatted with commas
```
</success_criteria>

<must_have_derivation>
**Goal:** Polished data visualization for tracks, playlists, and stats

**Critical behaviors:**
- Track table provides clear visual feedback on hover and play state
- Playlist cards communicate confidence through color coding
- Stat cards make metrics visually appealing and scannable
- All interactions feel smooth and responsive

**Critical artifacts:**
- TrackTable.jsx (enhanced track list with animations)
- PlaylistCard.jsx (for Phase 4 playlist display)
- StatCard.jsx (for library metrics)
- Component CSS files with styling

**Critical connections:**
- TrackTable uses Framer Motion for row animations
- PlaylistCard uses Card/Button components from Plan 02
- All components use design system variables from Plan 01
- Components will integrate into App.jsx for Phase 4
</must_have_derivation>
